# 02. ë¸Œë¼ìš°ì €

ğŸ”— https://github.com/jeonghwan-kim/lecture-http  
ğŸ”— https://jeonghwan-kim.github.io/2024/07/08/lecture-http-part2

- ì›¹ ê°œë°œ ì‹œ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” HTTP í´ë¼ì´ì–¸íŠ¸ëŠ” ì›¹ ë¸Œë¼ìš°ì €
- ìš°ë¦¬ê°€ ëª¨ë¥´ëŠ” ì‚¬ì´ì— ë¸Œë¼ìš°ì €ëŠ” HTTP ìš”ì²­ì„ ë§Œë“¤ê³  ì„œë²„ ì‘ë‹µì— ìë™ìœ¼ë¡œ ë°˜ì‘í•œë‹¤.

<hr>

- 3ì¥. ì»¨í…ì¸  í˜‘ìƒ: ì›¹ë¸Œë¼ìš°ì €ê°€ ì„œë²„ì™€ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ì„ ë•Œ ìµœì ì˜ í˜•íƒœë¡œ ë§Œë“¤ê¸° ìœ„í•œ ë§¤ì»¤ë‹ˆì¦˜ì„ ì´í•´í•  ìˆ˜ ìˆë‹¤.
- 4ì¥. ì¿ í‚¤: ì„œë²„ê°€ ì›¹ ë¸Œë¼ìš°ì €ë¥¼ ì‹ë³„í•˜ê¸° ìœ„í•œ ë°©ë²•ì¸ ì¿ í‚¤ì— ëŒ€í•´ ë°°ìš¸ ìˆ˜ ìˆë‹¤.
- 5ì¥. ë„¤íŠ¸ì›Œí¬ ìš”ì²­: ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” HTTP ìš”ì²­ì˜ ì¢…ë¥˜ì— ëŒ€í•´ ì•Œ ìˆ˜ ìˆë‹¤.

<br>

## 3ì¥. ì»¨í…ì¸  í˜‘ìƒ

- ì„œë²„ëŠ” ë‹¤ì–‘í•œ í´ë¼ì´ì–¸íŠ¸ì— ì í•©í•œ ìì›ì„ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤.
  - ê°™ì€ ë‚´ìš©ì´ë¼ë„ í´ë¼ì´ì–¸íŠ¸ë§ˆë‹¤ í•„ìš”í•œ ë¬¸ì„œ í˜•ì‹ì´ ë‹¤ë¥´ë‹¤.
  - ì••ì¶•í•œ ë¬¸ì„œë¥¼ ì½ì„ ìˆ˜ë„ ìˆì§€ë§Œ ê·¸ë ‡ì§€ ëª»í•œ í´ë¼ì´ì–¸íŠ¸ë„ ìˆë‹¤.
  - í´ë¼ì´ì–¸íŠ¸ê°€ ì„ í˜¸í•˜ëŠ” ì–¸ì–´ê°€ ë‹¤ë¥´ê¸°ë„ í•˜ë‹¤.
  - ì´ëŸ° ê°ì–‘ ê°ìƒ‰ì˜ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ìµœì ì˜ ìì›ì„ ì œê³µí•˜ëŠ” ê²ƒì´ ì„œë²„ì˜ ì—­í• 
  - í´ë¼ì´ì–¸íŠ¸ì™€ í•¨ê»˜ ì„œë¡œ ì…ì¥ ì°¨ì´ë¥¼ ì¤„ì—¬ë‚˜ê°€ê³  ì£¼ê³  ë°›ì„ ìì›ì˜ í˜•íƒœë¥¼ ê²°ì •í•˜ëŠ” ê²ƒì´ ì»¨í…ì¸  í˜‘ìƒì´ë‹¤.
- ì»¨í…ì¸  í˜‘ìƒì— ì‚¬ìš©ë˜ëŠ” HTTP í—¤ë”ì™€ ë™ì‘ ë°©ì‹ì„ ê³µë¶€í•©ë‹ˆë‹¤.

### 3.1 ì»¨í…ì¸  íƒ€ì…

> í´ë¼ì´ì–¸íŠ¸: htmlë¬¸ì„œë¡œ ë³´ë‚´ì£¼ì„¸ìš”

- Accept ìš”ì²­ í—¤ë”, Content-Type ì‘ë‹µ í—¤ë”

```shell
> Accept: text/html # í´ë¼ì´ì–¸íŠ¸ > ì„œë²„
< Content-Type: text/html # í´ë¼ì´ì–¸íŠ¸ < ì„œë²„
```

- ì‚¬ë¡€: gitHub
- ë¼ì´ë¸ŒëŸ¬ë¦¬: express.js ì˜ res.format í•¨ìˆ˜
  - ğŸ”— https://github.com/expressjs/express/blob/master/lib/response.js#L551

GitHubëŠ” ê°™ì€ URLì´ë¼ë„ Accept ìš”ì²­ í—¤ë”ì— ë”°ë¼ì„œ ë‹¤ì–‘í•œ í˜•ì‹ì˜ ìì›ì„ ì œê³µí•œë‹¤.

```shell
$ curl https://github.com/jeonghwan-kim/jeonghwan-kim.github.com -H "Accept: text/html"
```

ê²°ê³¼: ë§ˆí¬ì—… ì½”ë“œê°€ ë“¤ì–´ìˆëŠ” html ë¬¸ì„œë¥¼ ë³´ë‚´ì¤€ë‹¤.

```shell
$ curl https://github.com/jeonghwan-kim/jeonghwan-kim.github.com -H "Accept: application/json"
```

ê²°ê³¼: json í˜•ì‹ì˜ ë¬¸ì„œë¥¼ ì œê³µí•œë‹¤.

<br>

### 3.2 ì••ì¶•

> í´ë¼ì´ì–¸íŠ¸: ì €ëŠ” ì´ëŸ° ì••ì¶• ì•Œê³ ë¦¬ì¦˜ì„ ì•Œê³  ìˆì–´ìš” ê°€ëŠ¥í•˜ë©´ ì´ê±¸ë¡œ ë³´ë‚´ì£¼ì„¸ìš”

íŒŒì¼ì„ ì••ì¶•í•´ì„œ ì „ì†¡í•˜ë©´ ê·¸ë§Œí¼ ë„¤íŠ¸ì›Œí¬ ë¹„ìš©ì„ ì•„ë¼ê³  ë” ì‹ ì†í•˜ê²Œ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.

- Accept-Encoding ìš”ì²­ í—¤ë”, Content-Encoding ì‘ë‹µ í—¤ë”

```shell
> Accept-Encoding: gzip # í´ë¼ì´ì–¸íŠ¸ > ì„œë²„
< Content-Encoding: gzip  # í´ë¼ì´ì–¸íŠ¸ < ì„œë²„
```

- ì‚¬ë¡€: GitHub
- ë¼ì´ë¸ŒëŸ¬ë¦¬: Express.jsì˜ Compression(ì••ì¶• ë¯¸ë“¤ì›¨ì–´)
  - https://github.com/expressjs/compression

GitHubëŠ” ê°™ì€ URLì´ë¼ë„ Accept Encoding ìš”ì²­ í—¤ë“œì— ë”°ë¼ì„œ ìì›ì„ ì••ì¶•í•´ì„œ ì œê³µí•œë‹¤.

```shell
$ curl https://github.com/jeonghwan-kim/jeonghwan-kim.github.com -H "Accept-Encoding: gzip" -s -o result-gzip
$ cat result-gzip # mac
$ type result-gzip # window
```

- ê²°ê³¼: ì•Œ ìˆ˜ ì—†ê²Œ ì••ì¶•ë˜ì–´ ìˆëŠ” íŒŒì¼

```shell
# ì••ì¶• í’€ì–´ì„œ ë³´ê¸°
$ curl https://github.com/jeonghwan-kim/jeonghwan-kim.github.com -H "Accept-Encoding: gzip" -s --compressed
```

- ê²°ê³¼: ì••ì¶•ì„ í•´ì œí•˜ì—¬ ì½˜ì†”ë¡œ ì¶œë ¥í•´ì¤€ë‹¤.
  - ì••ì¶•ë¼ì„œ ë°ì´í„°ë¥¼ ìš”ì²­ > ì••ì¶•í•œ íŒŒì¼ì„ ì„œë²„ë¡œë¶€í„° ì „ë‹¬ ë°›ìŒ > ì••ì¶• í•´ì œí•˜ì—¬ ë°”ë¡œ ì½˜ì†”ì— ì¶œë ¥

### 3.3 ì–¸ì–´

> í´ë¼ì´ì–¸íŠ¸: ì´ URLì˜ ìì›ì„ ìš”ì²­í•˜ëŠ”ë°ìš” ê°€ëŠ¥í•˜ë©´ í•œê¸€ ë¬¸ì„œë¥¼ ì£¼ì„¸ìš”

- Accept-Language ìš”ì²­ í—¤ë”
  - í´ë¼ì´ì–¸íŠ¸ê°€ ì„ í˜¸í•˜ëŠ” ì–¸ì–´ë¥¼ ì„œë²„í•œí…Œ ì „ë‹¬í•˜ë©´ ì„œë²„ëŠ” ì¤€ë¹„ëœ ì–¸ì–´ì˜ ë¬¸ì„œë¥¼ ì œê³µí•œë‹¤.

```shell
> Accept-Language: ko
```

- ì‚¬ë¡€: ìœ íŠœë¸Œ
  - ë¸Œë¼ìš°ì €ì—ì„œ ì–¸ì–´ì„¤ì •ì„ ë³€ê²½í•˜ë©´ ê°™ì€ URLì´ë¼ë„ ë‹¤ë¥¸ ì›¹í˜ì´ì§€ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.
- ë¼ì´ë¸ŒëŸ¬ë¦¬: express.js req.acceptLanguage(), accepts, negotiator

### 3.4 ì‚¬ìš©ì ì—ì´ì „íŠ¸

- User-Agent ìš”ì²­ í—¤ë”
  - User-AgentëŠ” ê° ë¸Œë¼ìš°ì €ê°€ ì›í•˜ëŠ” ë¬¸ìì—´ì„ ì‚¬ìš©í•œë‹¤. (ê°€ë ¹ Chrome ë¸Œë¼ìš°ì €ì¸ë° Safari ë¬¸ìê°€ ìˆëŠ” ì‹)
  - ê·¸ë˜ì„œ User-Agent Sniffing ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ê²ƒ ì²˜ëŸ¼ ì´ ê°’ì€ ì¢€ ì‹ ë¢°í•˜ê¸° ì–´ë ¤ìš´ ê°’ì´ë‹¤.
    - https://developer.mozilla.org/ko/docs/Web/HTTP/Guides/Browser_detection_using_the_user_agent

```shell
# User-Agent: ì œí’ˆëª…/ë²„ì „ ì„¤ëª…
> User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
```

- ì‚¬ë¡€: êµ¬í˜• ë¸Œë¼ìš°ì ¸ ê°ì§€
- ë¼ì´ë¸ŒëŸ¬ë¦¬: express-useragent
  - https://github.com/biggora/express-useragent/blob/master/lib/express-useragent.js

```JasvaScript
/(?:chrome|crios)\/([\d\w\.\-]+)/i.test(navigator.userAgent) // true
```
